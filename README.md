This is a collection of Python scripts for simulating microlensing events. The scripts are used to generate lens and source pairs, assign masses to the lens objects, and calculate the resulting microlensing event parameters.

### `gen_lens_source.py`

This script generates a population of lens and source pairs based on a Galactic model. It simulates the spatial distribution of stars in the bulge and disk and calculates their kinematic properties, such as proper motions and velocities.

**Usage**

```bash
python gen_lens_source.py --lens-pos <lens_pos> [options]
```

**Arguments**

- `--lens-pos`: The lens position, which can be one of `bulge`, `disk`, or `bulge+disk`.
- `--l-deg`: Galactic longitude in degrees (default: -0.14).
- `--b-deg`: Galactic latitude in degrees (default: -1.62).
- `--nsample`: The number of samples to generate (default: 1,000,000).
- `--output`: The output file name (default: `{lens-pos}.res`).
- `--ds-min`, `--ds-max`: The minimum and maximum source distances in kpc (default: 0.0, 12.0).
- `--dl-min`, `--dl-max`: The minimum and maximum lens distances in kpc (default: 0.0, 12.0).
- `--dgc`: The distance to the Galactic center in kpc (default: 8.0).
- `--seed`: The random seed for the simulation.
- `--t0`: The observation time in JD-2450000 (default: 9500).

### `assign_mf.py`

This script assigns masses to the lens objects generated by `gen_lens_source.py`. It uses an initial mass function (IMF) to sample masses for different types of objects, including white dwarfs, neutron stars, and black holes. The script also applies natal kicks to neutron stars and black holes to account for the velocity imparted during their formation.

**Usage**

```bash
python assign_mf.py --file <input_file> --kick <kick_velocity> --seed <seed>
```

**Arguments**

- `--file`: The input file with kinematics data from `gen_lens_source.py`.
- `--kick`: The mean natal kick velocity for black holes in km/s.
- `--seed`: The random seed for the simulation. NOTE: This seed should be different from the one used in `gen_lens_source.py` to ensure independent random sampling.


### Workflow

1. **Generate lens-source pairs**: Run `gen_lens_source.py` to create a population of lens and source pairs with their kinematic properties.

   ```bash
   python gen_lens_source.py --lens-pos bulge --nsample 1000000 --seed 0
   ```

2. **Assign masses**: Use `assign_mf.py` to assign masses to the lens objects and apply natal kicks.

   ```bash
   python assign_mf.py --file bulge.res --kick 0 --seed 1
   ```

### Output

The output of `assign_mf.py` is a file with the suffix `.gwtc3` that contains the following columns:

- `dl`: Lens distance in kpc.
- `ds`: Source distance in kpc.
- `lens_pos`: The lens position (0 for bulge, 1 for disk).
- `pm_y`, `pm_z`: Proper motions in the y and z directions.
- `vl_y`, `vl_z`: Lens velocities in the y and z directions.
- `vs_y`, `vs_z`: Source velocities in the y and z directions.
- `mass`: The mass of the lens object in solar masses.
- `thetaE`: The Einstein radius in milliarcseconds.
- `piE`: The microlensing parallax.
- `tE`: The Einstein timescale in days.
- `stype`: The stellar type of the lens object (0 for other, 1 for white dwarf, 2 for neutron star, 3 for black hole).
- `wt`: The weight of the event.
